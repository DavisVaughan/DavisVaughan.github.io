<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Recreating RView’s Reproducible Finance With R: Sector Correlations</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/simplex.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/htmlwidgets-0.8/htmlwidgets.js"></script>
<link href="site_libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="site_libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="site_libs/moment-2.8.4/moment.js"></script>
<script src="site_libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="site_libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="site_libs/dygraphs-binding-1.1.1.4/dygraphs.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #dddddd; }
td.sourceCode { padding-left: 5px; }
code > span.kw { font-weight: bold; } /* Keyword */
code > span.dt { color: #800000; } /* DataType */
code > span.dv { color: #0000ff; } /* DecVal */
code > span.bn { color: #0000ff; } /* BaseN */
code > span.fl { color: #800080; } /* Float */
code > span.ch { color: #ff00ff; } /* Char */
code > span.st { color: #dd0000; } /* String */
code > span.co { color: #808080; font-style: italic; } /* Comment */
code > span.al { color: #00ff00; font-weight: bold; } /* Alert */
code > span.fu { color: #000080; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #ff0000; font-weight: bold; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #ff00ff; } /* SpecialChar */
code > span.vs { color: #dd0000; } /* VerbatimString */
code > span.ss { color: #dd0000; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { font-weight: bold; } /* Preprocessor */
code > span.at { } /* Attribute */
code > span.do { color: #808080; font-style: italic; } /* Documentation */
code > span.an { color: #808080; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #808080; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #808080; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="custom.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 41px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 46px;
  margin-top: -46px;
}

.section h2 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h3 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h4 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h5 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h6 {
  padding-top: 46px;
  margin-top: -46px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><div style="color:#009999;font-size:22px">dv-blog</div></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="blog_directory.html">blog</a>
</li>
<li>
  <a href="about.html">about</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Recreating RView’s ‘Reproducible Finance With R: Sector Correlations’</h1>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In the true spirit of reproducibility, we at Business Science thought that it would be appropriate to recreate the RViews <a href="https://www.rstudio.com/rviews/2017/01/18/reproducible-finance-with-r-sector-correlations/">post</a> on reproducibility with Sector Correlations. This time, however, the <code>tidyquant</code> package will be used to streamline much of the code that is currently used. The main advantage of <code>tidyquant</code> is to bridge the gap between the best quantitative resources for collecting and manipulating quantitative data: <code>xts</code>, <code>quantmod</code> and <code>TTR</code>, and the data modeling workflow and infrastructure of the <code>tidyverse</code>.</p>
<p>Let’s start by loading some packages.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyquant)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(dygraphs)</code></pre></div>
<p>We will be using the same tickers as RViews.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># List of tickers for sector etfs. </span>
ticker &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;XLY&quot;</span>, <span class="st">&quot;XLP&quot;</span>, <span class="st">&quot;XLE&quot;</span>,    <span class="st">&quot;XLF&quot;</span>, <span class="st">&quot;XLV&quot;</span>,   
            <span class="st">&quot;XLI&quot;</span>, <span class="st">&quot;XLB&quot;</span>, <span class="st">&quot;XLK&quot;</span>, <span class="st">&quot;XLU&quot;</span>, <span class="st">&quot;SPY&quot;</span>)  

<span class="co"># And the accompanying sector names for those ETFs.</span>
sector &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Consumer Discretionary&quot;</span>, <span class="st">&quot;Consumer Staples&quot;</span>, 
            <span class="st">&quot;Energy&quot;</span>, <span class="st">&quot;Financials&quot;</span>, <span class="st">&quot;Health Care&quot;</span>, <span class="st">&quot;Industrials&quot;</span>, 
            <span class="st">&quot;Materials&quot;</span>, <span class="st">&quot;Information Technology&quot;</span>, <span class="st">&quot;Utilities&quot;</span>, <span class="st">&quot;Index&quot;</span>)

etf_ticker_sector &lt;-<span class="st"> </span><span class="kw">tibble</span>(ticker, sector)

etf_ticker_sector</code></pre></div>
<pre><code>## # A tibble: 10 × 2
##    ticker                 sector
##     &lt;chr&gt;                  &lt;chr&gt;
## 1     XLY Consumer Discretionary
## 2     XLP       Consumer Staples
## 3     XLE                 Energy
## 4     XLF             Financials
## 5     XLV            Health Care
## 6     XLI            Industrials
## 7     XLB              Materials
## 8     XLK Information Technology
## 9     XLU              Utilities
## 10    SPY                  Index</code></pre>
</div>
<div id="section" class="section level1">
<h1></h1>
<!---------------------------------------------------------->
</div>
<div id="data-import" class="section level1 tabset tabset-fade">
<h1>Data Import</h1>
<p>Alright, now is where things get interesting. RViews created a function to import closing prices using <code>getSymbols()</code> directly from the <code>quantmod</code> package. They then used <code>periodReturn()</code> to convert these prices to weekly log returns. Let’s see how this could be done in <code>tidyquant</code>.</p>
<div id="bizsci" class="section level2">
<h2>BizSci</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">prices &lt;-<span class="st"> </span><span class="kw">tq_get</span>(etf_ticker_sector, <span class="dt">get =</span> <span class="st">&quot;stock.prices&quot;</span>) %&gt;%<span class="st"> </span><span class="kw">group_by</span>(ticker, sector)

etf_returns &lt;-<span class="st"> </span>prices %&gt;%<span class="st"> </span><span class="kw">tq_transform</span>(<span class="dt">ohlc_fun =</span> Cl,  <span class="dt">transform_fun =</span> periodReturn, 
                                       <span class="dt">period =</span> <span class="st">&#39;weekly&#39;</span>, <span class="dt">type =</span> <span class="st">&#39;log&#39;</span>)

<span class="kw">head</span>(etf_returns)</code></pre></div>
<pre><code>## Source: local data frame [6 x 4]
## Groups: ticker, sector [1]
## 
##   ticker                 sector       date weekly.returns
##    &lt;chr&gt;                  &lt;chr&gt;     &lt;date&gt;          &lt;dbl&gt;
## 1    XLY Consumer Discretionary 2007-01-05   -0.007034027
## 2    XLY Consumer Discretionary 2007-01-12    0.026062578
## 3    XLY Consumer Discretionary 2007-01-19    0.008875499
## 4    XLY Consumer Discretionary 2007-01-26   -0.019888442
## 5    XLY Consumer Discretionary 2007-02-02    0.022409825
## 6    XLY Consumer Discretionary 2007-02-09   -0.006315545</code></pre>
</div>
<div id="rviews" class="section level2">
<h2>RViews</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A function to build an xts object of etf returns.</span>

etf_weekly_returns &lt;-<span class="st"> </span>function(ticker) {

<span class="co"># Download prices using getSybmols    </span>
symbols &lt;-<span class="st"> </span><span class="kw">getSymbols</span>(ticker, <span class="dt">auto.assign =</span> <span class="ot">TRUE</span>, <span class="dt">warnings =</span> <span class="ot">FALSE</span>)
<span class="co"># Take just the Closing prices.</span>
etf_prices &lt;-<span class="st"> </span><span class="kw">do.call</span>(merge, <span class="kw">lapply</span>(symbols, function(x) <span class="kw">Cl</span>(<span class="kw">get</span>(x))))
<span class="co"># Use the periodReturn() function to get log weekly returns.    </span>
etf_returns &lt;-<span class="st"> </span><span class="kw">do.call</span>(merge, <span class="kw">lapply</span>(etf_prices, 
                                     function(x) <span class="kw">periodReturn</span>(x, <span class="dt">period =</span> <span class="st">&#39;weekly&#39;</span>, <span class="dt">type =</span> <span class="st">&#39;log&#39;</span>)))

<span class="co">#Change the column names to the sector names from our dataframe above.</span>

<span class="kw">colnames</span>(etf_returns) &lt;-<span class="st"> </span>etf_ticker_sector$sector
    
etf_returns

}

<span class="co"># Let&#39;s pass in our ticker symbols and build an xts object of etf returns</span>
etf_returns &lt;-<span class="st"> </span><span class="kw">etf_weekly_returns</span>(etf_ticker_sector$ticker)

<span class="kw">head</span>(etf_returns)</code></pre></div>
</div>
</div>
<div id="section-1" class="section level1">
<h1></h1>
<p>No need for <code>do.call()</code>, <code>lapply()</code> or any of that fun. It’s all been taken care of for you. Grouping by ticker (and sector to keep the column) allows us to perform the transform on each group separately, but with one line of code. Also, notice that the data is preserved in a <em>tidy</em> format, as opposed to the xts format that RViews uses. It would be easy to now create a function wrapping this like RViews did, allowing the user to just enter the tibble of tickers. This could be useful in the flexdashboard that they will create, but for this post, we chose not do to that.</p>
<!---------------------------------------------------------->
</div>
<div id="rolling-correlations" class="section level1 tabset tabset-fade">
<h1>Rolling Correlations</h1>
<p>The next step is to calculate <em>rolling correlations</em>. First let’s add the index (which is currently the last group in the tibble) as it’s own column. This is what our correlations will be calculated against. To do this, we will have to filter for that data, and inner join it with our original data set, easy.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">index &lt;-<span class="st"> </span><span class="kw">filter</span>(etf_returns, ticker ==<span class="st"> &quot;SPY&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">    </span>.[, <span class="kw">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;weekly.returns&quot;</span>)] %&gt;%
<span class="st">    </span><span class="kw">rename</span>(<span class="dt">index =</span> weekly.returns)

etf_returns &lt;-<span class="st"> </span><span class="kw">inner_join</span>(etf_returns, index, <span class="dt">by =</span> <span class="st">&quot;date&quot;</span>)

<span class="kw">head</span>(etf_returns)</code></pre></div>
<pre><code>## Source: local data frame [6 x 5]
## Groups: ticker, sector [1]
## 
##   ticker                 sector       date weekly.returns        index
##    &lt;chr&gt;                  &lt;chr&gt;     &lt;date&gt;          &lt;dbl&gt;        &lt;dbl&gt;
## 1    XLY Consumer Discretionary 2007-01-05   -0.007034027 -0.005888436
## 2    XLY Consumer Discretionary 2007-01-12    0.026062578  0.019029484
## 3    XLY Consumer Discretionary 2007-01-19    0.008875499 -0.002936435
## 4    XLY Consumer Discretionary 2007-01-26   -0.019888442 -0.004842978
## 5    XLY Consumer Discretionary 2007-02-02    0.022409825  0.018680358
## 6    XLY Consumer Discretionary 2007-02-09   -0.006315545 -0.006025965</code></pre>
<p>Now what? RViews used the more generic <code>rollapply()</code>, and then created the function for correlations. While this would definitely be possible using <code>tq_mutate</code>, it’s easier to just use the <code>runCor()</code> function from the <code>TTR</code> package through <code>tq_mutate_xy()</code> instead.</p>
<p>If you are new to <code>tidyquant</code>, <code>tq_mutate()</code> aggregates the functions from <code>TTR</code>, <code>xts</code>, and <code>quantmod</code> for OHLCV style data. As an added bonus, it keeps the data in tibble format for use in the tidyverse.</p>
<p><code>tq_mutate_xy()</code> works with functions from those packages that require two arguments (x and y), or if you have data that is not in OHLCV format. Here, we face both of those situations.</p>
<p>The usage of <code>runCor</code> by itself looks like: <code>runCor(x, y, n = 10)</code> so we will use <code>tq_mutate_xy()</code> to pass in the <code>x</code> and <code>y</code> arguments, and then pass through <code>n</code> using the <code>...</code>.</p>
<div id="bizsci-1" class="section level2">
<h2>BizSci</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">etf_returns_runCor &lt;-<span class="st"> </span>etf_returns %&gt;%<span class="st"> </span><span class="kw">tq_mutate_xy</span>(<span class="dt">x =</span> weekly.returns, <span class="dt">y =</span> index,
                                                   <span class="dt">col_rename =</span> <span class="st">&quot;cor&quot;</span>,
                                                   <span class="dt">mutate_fun =</span> runCor, 
                                                   <span class="dt">n =</span> <span class="dv">20</span>)
<span class="co"># Getting past the NA&#39;s</span>
<span class="kw">options</span>(<span class="dt">tibble.width =</span> <span class="ot">Inf</span>)
etf_returns_runCor[<span class="dv">15</span>:<span class="dv">25</span>,]</code></pre></div>
<pre><code>## Source: local data frame [11 x 6]
## Groups: ticker, sector [1]
## 
##    ticker                 sector       date weekly.returns         index
##     &lt;chr&gt;                  &lt;chr&gt;     &lt;date&gt;          &lt;dbl&gt;         &lt;dbl&gt;
## 1     XLY Consumer Discretionary 2007-04-13    0.001286277  0.0074596420
## 2     XLY Consumer Discretionary 2007-04-20    0.017076953  0.0224544236
## 3     XLY Consumer Discretionary 2007-04-27   -0.003544308  0.0061043558
## 4     XLY Consumer Discretionary 2007-05-04    0.001773724  0.0092528469
## 5     XLY Consumer Discretionary 2007-05-11   -0.005076178 -0.0003976208
## 6     XLY Consumer Discretionary 2007-05-18    0.010630371  0.0115988780
## 7     XLY Consumer Discretionary 2007-05-25   -0.001259680 -0.0061121613
## 8     XLY Consumer Discretionary 2007-06-01    0.016500474  0.0156329832
## 9     XLY Consumer Discretionary 2007-06-08   -0.022822407 -0.0199273050
## 10    XLY Consumer Discretionary 2007-06-15    0.010347196  0.0133507228
## 11    XLY Consumer Discretionary 2007-06-22   -0.011108496 -0.0166001040
##          cor
##        &lt;dbl&gt;
## 1         NA
## 2         NA
## 3         NA
## 4         NA
## 5         NA
## 6  0.9552300
## 7  0.9506605
## 8  0.9519602
## 9  0.9696367
## 10 0.9772809
## 11 0.9720909</code></pre>
</div>
<div id="rviews-1" class="section level2">
<h2>RViews</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A function that calculates the rolling correlation between a sector ETF and the SPY SP500 ETF. </span>

sector_index_correlation &lt;-<span class="st"> </span>function(x, window) {
    <span class="co"># Make one xts object to hold the sector returns and the SPY returns  </span>
    merged_xts &lt;-<span class="st"> </span><span class="kw">merge</span>(x, etf_returns$<span class="st">&#39;Index&#39;</span>)

    <span class="co"># Use rollapply() to calculate the rolling correlations. </span>
    <span class="co"># See what happens if you remove the &#39;pairwise.complete.obs&#39; argument - the NAs will cause problems.</span>
    merged_xts$rolling_cor &lt;-<span class="st"> </span><span class="kw">rollapply</span>(merged_xts, window, 
                                         function(x) <span class="kw">cor</span>(x[,<span class="dv">1</span>], x[,<span class="dv">2</span>], <span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>), 
                                         <span class="dt">by.column =</span> <span class="ot">FALSE</span>)
    
    <span class="kw">names</span>(merged_xts) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Sector Returns&quot;</span>, <span class="st">&quot;SPY Returns&quot;</span>, <span class="st">&quot;Sector/SPY Correlation&quot;</span>)
    
    merged_xts
}

<span class="co"># Choose a sector ETF and a rolling window and pass them to the function we just build. </span>
<span class="co"># Let&#39;s go with a 5 month window and the Information Technology sector.</span>
<span class="co"># We will now have a new xts object with 3 time series: sector returns, SPY returns</span>
<span class="co"># and the rolling correlation between those return series.</span>

IT_SPY_correlation &lt;-<span class="st"> </span><span class="kw">sector_index_correlation</span>(etf_returns$<span class="st">&#39;Information Technology&#39;</span>, <span class="dv">20</span>)

<span class="co"># Have a peek. The first 20 rows in the correlation column should be </span>
<span class="co"># NAs. </span>

<span class="kw">head</span>(IT_SPY_correlation, <span class="dt">n =</span> <span class="dv">25</span>)</code></pre></div>
</div>
</div>
<div id="section-2" class="section level1">
<h1></h1>
<p>Also, as opposed to the RViews function, this actually calculated the rolling correlations for <em>all</em> of the groups in the tibble, not just the one that you pass in.</p>
<!---------------------------------------------------------->
</div>
<div id="dygraph" class="section level1 tabset tabset-fade">
<h1>Dygraph</h1>
<p>Finally, let’s recreate the Dygraph for the Information Tech sector. The most useful feature here is <code>as_xts()</code> a <code>tidyquant</code> function that provides an easy way to convert from tibbles to xts. Extracting just the cor column from that then allows us to use the same code as RViews to create the graph.</p>
<div id="bizsci-2" class="section level2">
<h2>BizSci</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(etf_returns_runCor, sector ==<span class="st"> &quot;Information Technology&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">as_xts</span>(<span class="dt">date_col =</span> date) %&gt;%<span class="st"> </span>
<span class="st">  </span>.$cor %&gt;%
<span class="st">  </span><span class="kw">dygraph</span>(<span class="dt">main =</span> <span class="st">&quot;Correlation between SP500 and Tech ETF&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">dyAxis</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Correlation&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">dyRangeSelector</span>(<span class="dt">height =</span> <span class="dv">20</span>) %&gt;%
<span class="st">    </span><span class="co"># Add shading for the recessionary period</span>
<span class="st">    </span><span class="kw">dyShading</span>(<span class="dt">from =</span> <span class="st">&quot;2007-12-01&quot;</span>, <span class="dt">to =</span> <span class="st">&quot;2009-06-01&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;#FFE6E6&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="co"># Add an event for the financial crisis. </span>
<span class="st">    </span><span class="kw">dyEvent</span>(<span class="dt">x =</span> <span class="st">&quot;2008-09-15&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Fin Crisis&quot;</span>, <span class="dt">labelLoc =</span> <span class="st">&quot;top&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<div id="htmlwidget-5ca426451a034e604506" style="width:672px;height:480px;" class="dygraphs html-widget"></div>
<script type="application/json" data-for="htmlwidget-5ca426451a034e604506">{"x":{"attrs":{"axes":{"x":{"pixelsPerLabel":60},"y":[]},"title":"Correlation between SP500 and Tech ETF","labels":["week","cor"],"legend":"auto","retainDateWindow":false,"ylabel":"Correlation","showRangeSelector":true,"rangeSelectorHeight":20,"rangeSelectorPlotFillColor":" #A7B1C4","rangeSelectorPlotStrokeColor":"#808FAB","interactionModel":"Dygraph.Interaction.defaultModel"},"scale":"weekly","annotations":[],"shadings":[{"from":"2007-12-01T00:00:00.000Z","to":"2009-06-01T00:00:00.000Z","color":"#FFE6E6","axis":"x"}],"events":[{"pos":"2008-09-15T00:00:00.000Z","label":"Fin Crisis","labelLoc":"top","color":"red","strokePattern":[7,3],"axis":"x"}],"format":"date","data":[["2007-01-05T00:00:00.000Z","2007-01-12T00:00:00.000Z","2007-01-19T00:00:00.000Z","2007-01-26T00:00:00.000Z","2007-02-02T00:00:00.000Z","2007-02-09T00:00:00.000Z","2007-02-16T00:00:00.000Z","2007-02-23T00:00:00.000Z","2007-03-02T00:00:00.000Z","2007-03-09T00:00:00.000Z","2007-03-16T00:00:00.000Z","2007-03-23T00:00:00.000Z","2007-03-30T00:00:00.000Z","2007-04-05T00:00:00.000Z","2007-04-13T00:00:00.000Z","2007-04-20T00:00:00.000Z","2007-04-27T00:00:00.000Z","2007-05-04T00:00:00.000Z","2007-05-11T00:00:00.000Z","2007-05-18T00:00:00.000Z","2007-05-25T00:00:00.000Z","2007-06-01T00:00:00.000Z","2007-06-08T00:00:00.000Z","2007-06-15T00:00:00.000Z","2007-06-22T00:00:00.000Z","2007-06-29T00:00:00.000Z","2007-07-06T00:00:00.000Z","2007-07-13T00:00:00.000Z","2007-07-20T00:00:00.000Z","2007-07-27T00:00:00.000Z","2007-08-03T00:00:00.000Z","2007-08-10T00:00:00.000Z","2007-08-17T00:00:00.000Z","2007-08-24T00:00:00.000Z","2007-08-31T00:00:00.000Z","2007-09-07T00:00:00.000Z","2007-09-14T00:00:00.000Z","2007-09-21T00:00:00.000Z","2007-09-28T00:00:00.000Z","2007-10-05T00:00:00.000Z","2007-10-12T00:00:00.000Z","2007-10-19T00:00:00.000Z","2007-10-26T00:00:00.000Z","2007-11-02T00:00:00.000Z","2007-11-09T00:00:00.000Z","2007-11-16T00:00:00.000Z","2007-11-23T00:00:00.000Z","2007-11-30T00:00:00.000Z","2007-12-07T00:00:00.000Z","2007-12-14T00:00:00.000Z","2007-12-21T00:00:00.000Z","2007-12-28T00:00:00.000Z","2008-01-04T00:00:00.000Z","2008-01-11T00:00:00.000Z","2008-01-18T00:00:00.000Z","2008-01-25T00:00:00.000Z","2008-02-01T00:00:00.000Z","2008-02-08T00:00:00.000Z","2008-02-15T00:00:00.000Z","2008-02-22T00:00:00.000Z","2008-02-29T00:00:00.000Z","2008-03-07T00:00:00.000Z","2008-03-14T00:00:00.000Z","2008-03-20T00:00:00.000Z","2008-03-28T00:00:00.000Z","2008-04-04T00:00:00.000Z","2008-04-11T00:00:00.000Z","2008-04-18T00:00:00.000Z","2008-04-25T00:00:00.000Z","2008-05-02T00:00:00.000Z","2008-05-09T00:00:00.000Z","2008-05-16T00:00:00.000Z","2008-05-23T00:00:00.000Z","2008-05-30T00:00:00.000Z","2008-06-06T00:00:00.000Z","2008-06-13T00:00:00.000Z","2008-06-20T00:00:00.000Z","2008-06-27T00:00:00.000Z","2008-07-03T00:00:00.000Z","2008-07-11T00:00:00.000Z","2008-07-18T00:00:00.000Z","2008-07-25T00:00:00.000Z","2008-08-01T00:00:00.000Z","2008-08-08T00:00:00.000Z","2008-08-15T00:00:00.000Z","2008-08-22T00:00:00.000Z","2008-08-29T00:00:00.000Z","2008-09-05T00:00:00.000Z","2008-09-12T00:00:00.000Z","2008-09-19T00:00:00.000Z","2008-09-26T00:00:00.000Z","2008-10-03T00:00:00.000Z","2008-10-10T00:00:00.000Z","2008-10-17T00:00:00.000Z","2008-10-24T00:00:00.000Z","2008-10-31T00:00:00.000Z","2008-11-07T00:00:00.000Z","2008-11-14T00:00:00.000Z","2008-11-21T00:00:00.000Z","2008-11-28T00:00:00.000Z","2008-12-05T00:00:00.000Z","2008-12-12T00:00:00.000Z","2008-12-19T00:00:00.000Z","2008-12-26T00:00:00.000Z","2009-01-02T00:00:00.000Z","2009-01-09T00:00:00.000Z","2009-01-16T00:00:00.000Z","2009-01-23T00:00:00.000Z","2009-01-30T00:00:00.000Z","2009-02-06T00:00:00.000Z","2009-02-13T00:00:00.000Z","2009-02-20T00:00:00.000Z","2009-02-27T00:00:00.000Z","2009-03-06T00:00:00.000Z","2009-03-13T00:00:00.000Z","2009-03-20T00:00:00.000Z","2009-03-27T00:00:00.000Z","2009-04-03T00:00:00.000Z","2009-04-09T00:00:00.000Z","2009-04-17T00:00:00.000Z","2009-04-24T00:00:00.000Z","2009-05-01T00:00:00.000Z","2009-05-08T00:00:00.000Z","2009-05-15T00:00:00.000Z","2009-05-22T00:00:00.000Z","2009-05-29T00:00:00.000Z","2009-06-05T00:00:00.000Z","2009-06-12T00:00:00.000Z","2009-06-19T00:00:00.000Z","2009-06-26T00:00:00.000Z","2009-07-02T00:00:00.000Z","2009-07-10T00:00:00.000Z","2009-07-17T00:00:00.000Z","2009-07-24T00:00:00.000Z","2009-07-31T00:00:00.000Z","2009-08-07T00:00:00.000Z","2009-08-14T00:00:00.000Z","2009-08-21T00:00:00.000Z","2009-08-28T00:00:00.000Z","2009-09-04T00:00:00.000Z","2009-09-11T00:00:00.000Z","2009-09-18T00:00:00.000Z","2009-09-25T00:00:00.000Z","2009-10-02T00:00:00.000Z","2009-10-09T00:00:00.000Z","2009-10-16T00:00:00.000Z","2009-10-23T00:00:00.000Z","2009-10-30T00:00:00.000Z","2009-11-06T00:00:00.000Z","2009-11-13T00:00:00.000Z","2009-11-20T00:00:00.000Z","2009-11-27T00:00:00.000Z","2009-12-04T00:00:00.000Z","2009-12-11T00:00:00.000Z","2009-12-18T00:00:00.000Z","2009-12-24T00:00:00.000Z","2009-12-31T00:00:00.000Z","2010-01-08T00:00:00.000Z","2010-01-15T00:00:00.000Z","2010-01-22T00:00:00.000Z","2010-01-29T00:00:00.000Z","2010-02-05T00:00:00.000Z","2010-02-12T00:00:00.000Z","2010-02-19T00:00:00.000Z","2010-02-26T00:00:00.000Z","2010-03-05T00:00:00.000Z","2010-03-12T00:00:00.000Z","2010-03-19T00:00:00.000Z","2010-03-26T00:00:00.000Z","2010-04-01T00:00:00.000Z","2010-04-09T00:00:00.000Z","2010-04-16T00:00:00.000Z","2010-04-23T00:00:00.000Z","2010-04-30T00:00:00.000Z","2010-05-07T00:00:00.000Z","2010-05-14T00:00:00.000Z","2010-05-21T00:00:00.000Z","2010-05-28T00:00:00.000Z","2010-06-04T00:00:00.000Z","2010-06-11T00:00:00.000Z","2010-06-18T00:00:00.000Z","2010-06-25T00:00:00.000Z","2010-07-02T00:00:00.000Z","2010-07-09T00:00:00.000Z","2010-07-16T00:00:00.000Z","2010-07-23T00:00:00.000Z","2010-07-30T00:00:00.000Z","2010-08-06T00:00:00.000Z","2010-08-13T00:00:00.000Z","2010-08-20T00:00:00.000Z","2010-08-27T00:00:00.000Z","2010-09-03T00:00:00.000Z","2010-09-10T00:00:00.000Z","2010-09-17T00:00:00.000Z","2010-09-24T00:00:00.000Z","2010-10-01T00:00:00.000Z","2010-10-08T00:00:00.000Z","2010-10-15T00:00:00.000Z","2010-10-22T00:00:00.000Z","2010-10-29T00:00:00.000Z","2010-11-05T00:00:00.000Z","2010-11-12T00:00:00.000Z","2010-11-19T00:00:00.000Z","2010-11-26T00:00:00.000Z","2010-12-03T00:00:00.000Z","2010-12-10T00:00:00.000Z","2010-12-17T00:00:00.000Z","2010-12-23T00:00:00.000Z","2010-12-31T00:00:00.000Z","2011-01-07T00:00:00.000Z","2011-01-14T00:00:00.000Z","2011-01-21T00:00:00.000Z","2011-01-28T00:00:00.000Z","2011-02-04T00:00:00.000Z","2011-02-11T00:00:00.000Z","2011-02-18T00:00:00.000Z","2011-02-25T00:00:00.000Z","2011-03-04T00:00:00.000Z","2011-03-11T00:00:00.000Z","2011-03-18T00:00:00.000Z","2011-03-25T00:00:00.000Z","2011-04-01T00:00:00.000Z","2011-04-08T00:00:00.000Z","2011-04-15T00:00:00.000Z","2011-04-21T00:00:00.000Z","2011-04-29T00:00:00.000Z","2011-05-06T00:00:00.000Z","2011-05-13T00:00:00.000Z","2011-05-20T00:00:00.000Z","2011-05-27T00:00:00.000Z","2011-06-03T00:00:00.000Z","2011-06-10T00:00:00.000Z","2011-06-17T00:00:00.000Z","2011-06-24T00:00:00.000Z","2011-07-01T00:00:00.000Z","2011-07-08T00:00:00.000Z","2011-07-15T00:00:00.000Z","2011-07-22T00:00:00.000Z","2011-07-29T00:00:00.000Z","2011-08-05T00:00:00.000Z","2011-08-12T00:00:00.000Z","2011-08-19T00:00:00.000Z","2011-08-26T00:00:00.000Z","2011-09-02T00:00:00.000Z","2011-09-09T00:00:00.000Z","2011-09-16T00:00:00.000Z","2011-09-23T00:00:00.000Z","2011-09-30T00:00:00.000Z","2011-10-07T00:00:00.000Z","2011-10-14T00:00:00.000Z","2011-10-21T00:00:00.000Z","2011-10-28T00:00:00.000Z","2011-11-04T00:00:00.000Z","2011-11-11T00:00:00.000Z","2011-11-18T00:00:00.000Z","2011-11-25T00:00:00.000Z","2011-12-02T00:00:00.000Z","2011-12-09T00:00:00.000Z","2011-12-16T00:00:00.000Z","2011-12-23T00:00:00.000Z","2011-12-30T00:00:00.000Z","2012-01-06T00:00:00.000Z","2012-01-13T00:00:00.000Z","2012-01-20T00:00:00.000Z","2012-01-27T00:00:00.000Z","2012-02-03T00:00:00.000Z","2012-02-10T00:00:00.000Z","2012-02-17T00:00:00.000Z","2012-02-24T00:00:00.000Z","2012-03-02T00:00:00.000Z","2012-03-09T00:00:00.000Z","2012-03-16T00:00:00.000Z","2012-03-23T00:00:00.000Z","2012-03-30T00:00:00.000Z","2012-04-05T00:00:00.000Z","2012-04-13T00:00:00.000Z","2012-04-20T00:00:00.000Z","2012-04-27T00:00:00.000Z","2012-05-04T00:00:00.000Z","2012-05-11T00:00:00.000Z","2012-05-18T00:00:00.000Z","2012-05-25T00:00:00.000Z","2012-06-01T00:00:00.000Z","2012-06-08T00:00:00.000Z","2012-06-15T00:00:00.000Z","2012-06-22T00:00:00.000Z","2012-06-29T00:00:00.000Z","2012-07-06T00:00:00.000Z","2012-07-13T00:00:00.000Z","2012-07-20T00:00:00.000Z","2012-07-27T00:00:00.000Z","2012-08-03T00:00:00.000Z","2012-08-10T00:00:00.000Z","2012-08-17T00:00:00.000Z","2012-08-24T00:00:00.000Z","2012-08-31T00:00:00.000Z","2012-09-07T00:00:00.000Z","2012-09-14T00:00:00.000Z","2012-09-21T00:00:00.000Z","2012-09-28T00:00:00.000Z","2012-10-05T00:00:00.000Z","2012-10-12T00:00:00.000Z","2012-10-19T00:00:00.000Z","2012-10-26T00:00:00.000Z","2012-11-02T00:00:00.000Z","2012-11-09T00:00:00.000Z","2012-11-16T00:00:00.000Z","2012-11-23T00:00:00.000Z","2012-11-30T00:00:00.000Z","2012-12-07T00:00:00.000Z","2012-12-14T00:00:00.000Z","2012-12-21T00:00:00.000Z","2012-12-28T00:00:00.000Z","2013-01-04T00:00:00.000Z","2013-01-11T00:00:00.000Z","2013-01-18T00:00:00.000Z","2013-01-25T00:00:00.000Z","2013-02-01T00:00:00.000Z","2013-02-08T00:00:00.000Z","2013-02-15T00:00:00.000Z","2013-02-22T00:00:00.000Z","2013-03-01T00:00:00.000Z","2013-03-08T00:00:00.000Z","2013-03-15T00:00:00.000Z","2013-03-22T00:00:00.000Z","2013-03-28T00:00:00.000Z","2013-04-05T00:00:00.000Z","2013-04-12T00:00:00.000Z","2013-04-19T00:00:00.000Z","2013-04-26T00:00:00.000Z","2013-05-03T00:00:00.000Z","2013-05-10T00:00:00.000Z","2013-05-17T00:00:00.000Z","2013-05-24T00:00:00.000Z","2013-05-31T00:00:00.000Z","2013-06-07T00:00:00.000Z","2013-06-14T00:00:00.000Z","2013-06-21T00:00:00.000Z","2013-06-28T00:00:00.000Z","2013-07-05T00:00:00.000Z","2013-07-12T00:00:00.000Z","2013-07-19T00:00:00.000Z","2013-07-26T00:00:00.000Z","2013-08-02T00:00:00.000Z","2013-08-09T00:00:00.000Z","2013-08-16T00:00:00.000Z","2013-08-23T00:00:00.000Z","2013-08-30T00:00:00.000Z","2013-09-06T00:00:00.000Z","2013-09-13T00:00:00.000Z","2013-09-20T00:00:00.000Z","2013-09-27T00:00:00.000Z","2013-10-04T00:00:00.000Z","2013-10-11T00:00:00.000Z","2013-10-18T00:00:00.000Z","2013-10-25T00:00:00.000Z","2013-11-01T00:00:00.000Z","2013-11-08T00:00:00.000Z","2013-11-15T00:00:00.000Z","2013-11-22T00:00:00.000Z","2013-11-29T00:00:00.000Z","2013-12-06T00:00:00.000Z","2013-12-13T00:00:00.000Z","2013-12-20T00:00:00.000Z","2013-12-27T00:00:00.000Z","2014-01-03T00:00:00.000Z","2014-01-10T00:00:00.000Z","2014-01-17T00:00:00.000Z","2014-01-24T00:00:00.000Z","2014-01-31T00:00:00.000Z","2014-02-07T00:00:00.000Z","2014-02-14T00:00:00.000Z","2014-02-21T00:00:00.000Z","2014-02-28T00:00:00.000Z","2014-03-07T00:00:00.000Z","2014-03-14T00:00:00.000Z","2014-03-21T00:00:00.000Z","2014-03-28T00:00:00.000Z","2014-04-04T00:00:00.000Z","2014-04-11T00:00:00.000Z","2014-04-17T00:00:00.000Z","2014-04-25T00:00:00.000Z","2014-05-02T00:00:00.000Z","2014-05-09T00:00:00.000Z","2014-05-16T00:00:00.000Z","2014-05-23T00:00:00.000Z","2014-05-30T00:00:00.000Z","2014-06-06T00:00:00.000Z","2014-06-13T00:00:00.000Z","2014-06-20T00:00:00.000Z","2014-06-27T00:00:00.000Z","2014-07-03T00:00:00.000Z","2014-07-11T00:00:00.000Z","2014-07-18T00:00:00.000Z","2014-07-25T00:00:00.000Z","2014-08-01T00:00:00.000Z","2014-08-08T00:00:00.000Z","2014-08-15T00:00:00.000Z","2014-08-22T00:00:00.000Z","2014-08-29T00:00:00.000Z","2014-09-05T00:00:00.000Z","2014-09-12T00:00:00.000Z","2014-09-19T00:00:00.000Z","2014-09-26T00:00:00.000Z","2014-10-03T00:00:00.000Z","2014-10-10T00:00:00.000Z","2014-10-17T00:00:00.000Z","2014-10-24T00:00:00.000Z","2014-10-31T00:00:00.000Z","2014-11-07T00:00:00.000Z","2014-11-14T00:00:00.000Z","2014-11-21T00:00:00.000Z","2014-11-28T00:00:00.000Z","2014-12-05T00:00:00.000Z","2014-12-12T00:00:00.000Z","2014-12-19T00:00:00.000Z","2014-12-26T00:00:00.000Z","2015-01-02T00:00:00.000Z","2015-01-09T00:00:00.000Z","2015-01-16T00:00:00.000Z","2015-01-23T00:00:00.000Z","2015-01-30T00:00:00.000Z","2015-02-06T00:00:00.000Z","2015-02-13T00:00:00.000Z","2015-02-20T00:00:00.000Z","2015-02-27T00:00:00.000Z","2015-03-06T00:00:00.000Z","2015-03-13T00:00:00.000Z","2015-03-20T00:00:00.000Z","2015-03-27T00:00:00.000Z","2015-04-02T00:00:00.000Z","2015-04-10T00:00:00.000Z","2015-04-17T00:00:00.000Z","2015-04-24T00:00:00.000Z","2015-05-01T00:00:00.000Z","2015-05-08T00:00:00.000Z","2015-05-15T00:00:00.000Z","2015-05-22T00:00:00.000Z","2015-05-29T00:00:00.000Z","2015-06-05T00:00:00.000Z","2015-06-12T00:00:00.000Z","2015-06-19T00:00:00.000Z","2015-06-26T00:00:00.000Z","2015-07-02T00:00:00.000Z","2015-07-10T00:00:00.000Z","2015-07-17T00:00:00.000Z","2015-07-24T00:00:00.000Z","2015-07-31T00:00:00.000Z","2015-08-07T00:00:00.000Z","2015-08-14T00:00:00.000Z","2015-08-21T00:00:00.000Z","2015-08-28T00:00:00.000Z","2015-09-04T00:00:00.000Z","2015-09-11T00:00:00.000Z","2015-09-18T00:00:00.000Z","2015-09-25T00:00:00.000Z","2015-10-02T00:00:00.000Z","2015-10-09T00:00:00.000Z","2015-10-16T00:00:00.000Z","2015-10-23T00:00:00.000Z","2015-10-30T00:00:00.000Z","2015-11-06T00:00:00.000Z","2015-11-13T00:00:00.000Z","2015-11-20T00:00:00.000Z","2015-11-27T00:00:00.000Z","2015-12-04T00:00:00.000Z","2015-12-11T00:00:00.000Z","2015-12-18T00:00:00.000Z","2015-12-24T00:00:00.000Z","2015-12-31T00:00:00.000Z","2016-01-08T00:00:00.000Z","2016-01-15T00:00:00.000Z","2016-01-22T00:00:00.000Z","2016-01-29T00:00:00.000Z","2016-02-05T00:00:00.000Z","2016-02-12T00:00:00.000Z","2016-02-19T00:00:00.000Z","2016-02-26T00:00:00.000Z","2016-03-04T00:00:00.000Z","2016-03-11T00:00:00.000Z","2016-03-18T00:00:00.000Z","2016-03-24T00:00:00.000Z","2016-04-01T00:00:00.000Z","2016-04-08T00:00:00.000Z","2016-04-15T00:00:00.000Z","2016-04-22T00:00:00.000Z","2016-04-29T00:00:00.000Z","2016-05-06T00:00:00.000Z","2016-05-13T00:00:00.000Z","2016-05-20T00:00:00.000Z","2016-05-27T00:00:00.000Z","2016-06-03T00:00:00.000Z","2016-06-10T00:00:00.000Z","2016-06-17T00:00:00.000Z","2016-06-24T00:00:00.000Z","2016-07-01T00:00:00.000Z","2016-07-08T00:00:00.000Z","2016-07-15T00:00:00.000Z","2016-07-22T00:00:00.000Z","2016-07-29T00:00:00.000Z","2016-08-05T00:00:00.000Z","2016-08-12T00:00:00.000Z","2016-08-19T00:00:00.000Z","2016-08-26T00:00:00.000Z","2016-09-02T00:00:00.000Z","2016-09-09T00:00:00.000Z","2016-09-16T00:00:00.000Z","2016-09-23T00:00:00.000Z","2016-09-30T00:00:00.000Z","2016-10-07T00:00:00.000Z","2016-10-14T00:00:00.000Z","2016-10-21T00:00:00.000Z","2016-10-28T00:00:00.000Z","2016-11-04T00:00:00.000Z","2016-11-11T00:00:00.000Z","2016-11-18T00:00:00.000Z","2016-11-25T00:00:00.000Z","2016-12-02T00:00:00.000Z","2016-12-09T00:00:00.000Z","2016-12-16T00:00:00.000Z","2016-12-23T00:00:00.000Z","2016-12-30T00:00:00.000Z","2017-01-06T00:00:00.000Z","2017-01-13T00:00:00.000Z","2017-01-20T00:00:00.000Z","2017-01-27T00:00:00.000Z","2017-01-31T00:00:00.000Z"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"0.8820099","0.8963962","0.8946237","0.9301269","0.9311254","0.9302817","0.9303941","0.9315747","0.9328206","0.8887265","0.9413559","0.9425400","0.9227779","0.8902191","0.8926453","0.8863329","0.8937554","0.8725165","0.8770879","0.8786019","0.8844861","0.8820588","0.8768764","0.8822441","0.8609198","0.8380142","0.8382795","0.8325271","0.8260712","0.8369931","0.7966426","0.7946670","0.8025506","0.8466905","0.8204241","0.8430392","0.8326138","0.8475824","0.8595966","0.8633069","0.8557507","0.8560491","0.8518720","0.8400306","0.8672960","0.8708014","0.8879813","0.8916630","0.8995478","0.8991973","0.9075836","0.9053348","0.9102228","0.9125100","0.9287030","0.9209133","0.9307137","0.9400208","0.9344129","0.9219701","0.9281848","0.9309569","0.9404998","0.9277252","0.9209683","0.9212198","0.9162297","0.9034905","0.8955512","0.8946648","0.8819902","0.8538012","0.9026220","0.9148581","0.9227980","0.9195139","0.9369700","0.9353289","0.9369255","0.9384986","0.9499116","0.9496858","0.9498164","0.9506242","0.9569675","0.9595288","0.9591451","0.9605618","0.9615748","0.9605908","0.9588279","0.9609877","0.9650933","0.9592747","0.9530811","0.9633488","0.9545217","0.9641773","0.9574941","0.9467591","0.9382019","0.9369486","0.9371006","0.8512598","0.8528044","0.8364725","0.8365849","0.8246748","0.8234583","0.8304878","0.8387302","0.8284116","0.8006208","0.8034765","0.7766859","0.7181185","0.7128269","0.6826682","0.6797335","0.6877590","0.6960371","0.7062230","0.7057356","0.9234713","0.9419583","0.9437482","0.9345271","0.9337043","0.9436376","0.9505739","0.9497435","0.9445410","0.9414350","0.9245842","0.9162702","0.9115513","0.9332301","0.9341377","0.8983273","0.8955537","0.9117506","0.9000566","0.8948691","0.8943874","0.8932033","0.8788974","0.8932459","0.9065829","0.8920357","0.8811535","0.8687713","0.8727398","0.8610563","0.8638388","0.8816240","0.9378052","0.9402156","0.9491342","0.9657279","0.9598837","0.9494808","0.9564854","0.9655625","0.9713854","0.9763503","0.9736512","0.9750548","0.9725622","0.9729327","0.9736640","0.9726127","0.9703555","0.9747109","0.9745603","0.9604575","0.9508783","0.9492211","0.9415248","0.9296764","0.9328848","0.9371188","0.9370959","0.9312619","0.9054100","0.8813792","0.8810667","0.8686193","0.8727047","0.8696696","0.8121254","0.8149214","0.8051502","0.8001117","0.7960058","0.8590066","0.8463845","0.8375397","0.8599191","0.9028999","0.9074576","0.9294889","0.9283141","0.9121724","0.9122467","0.9292956","0.9400972","0.9356104","0.9242607","0.9263334","0.9257477","0.9306746","0.9285477","0.9374570","0.9460004","0.9305520","0.9616771","0.9596325","0.9589638","0.9612719","0.9621093","0.9626112","0.9608428","0.9574200","0.9648977","0.9632887","0.9607332","0.9672354","0.9535470","0.9481628","0.9525953","0.9602780","0.9413542","0.9438944","0.9462913","0.9451290","0.9409012","0.9449814","0.9529299","0.9525918","0.9523737","0.9464817","0.9472260","0.9468526","0.9434033","0.9449281","0.9460935","0.9441014","0.9506906","0.9537153","0.9527929","0.9441866","0.9744933","0.9730449","0.9716774","0.9727410","0.9669779","0.9586522","0.8953237","0.8968693","0.8742275","0.9125399","0.9399124","0.9351009","0.9427560","0.9484404","0.9443002","0.9388108","0.9376436","0.9352457","0.9198459","0.9146045","0.9162471","0.9072216","0.9101192","0.9068767","0.9106962","0.9063219","0.9273122","0.9264984","0.9172017","0.9147336","0.8522887","0.8734690","0.8166512","0.7550938","0.7579761","0.8056200","0.8220188","0.8702496","0.8838444","0.8827868","0.8799812","0.8847590","0.8918543","0.9225360","0.9228119","0.9150200","0.9001617","0.8871722","0.8945191","0.8893235","0.8948996","0.8800394","0.9220908","0.9238632","0.9228203","0.9110599","0.9079434","0.8895340","0.9143374","0.9229425","0.9043890","0.9086653","0.9031053","0.8996313","0.8711044","0.8880047","0.9193129","0.9346218","0.9333575","0.9382575","0.9393320","0.8986931","0.8825788","0.8836186","0.8837228","0.8582178","0.8534519","0.8581196","0.8420559","0.8372191","0.8473675","0.8431300","0.8276011","0.8262371","0.8563123","0.8603325","0.8519497","0.8040326","0.8118711","0.7954724","0.7215294","0.8492735","0.8783139","0.8879121","0.8827912","0.9130876","0.9117792","0.8365955","0.8692052","0.8634665","0.8678895","0.8845440","0.8842129","0.8840497","0.8522705","0.8776439","0.8713899","0.8722062","0.8590534","0.8840162","0.9132924","0.9098873","0.8984786","0.8904040","0.8782933","0.8816341","0.8874295","0.9102674","0.9039570","0.8877709","0.8796508","0.8637001","0.8582891","0.8504834","0.8624423","0.8748773","0.8709546","0.8759179","0.9014258","0.8663546","0.8474408","0.8594541","0.8508454","0.8709288","0.8862828","0.9159110","0.9150263","0.9435813","0.9512188","0.9625928","0.9539887","0.9404016","0.9260143","0.9145389","0.9330811","0.9299159","0.9303561","0.9298959","0.9251308","0.9266574","0.9281645","0.9395943","0.9447569","0.9412079","0.9411547","0.9302865","0.9318792","0.9216625","0.9184233","0.9253072","0.9321264","0.9409048","0.9550200","0.9533050","0.9486831","0.9534289","0.9536803","0.9512473","0.9521718","0.9509005","0.9447548","0.9263864","0.9272381","0.9177103","0.9091387","0.9232090","0.9272895","0.9206034","0.9135982","0.9009906","0.9477128","0.9407129","0.9405193","0.9477465","0.9481190","0.9476633","0.9442750","0.9496391","0.9511924","0.9469489","0.9477332","0.9518656","0.9582827","0.9617647","0.9618382","0.9603751","0.9627413","0.9661462","0.9639248","0.9644091","0.9639712","0.9700464","0.9682361","0.9676648","0.9687425","0.9706020","0.9740775","0.9725042","0.9725014","0.9794091","0.9798035","0.9783759","0.9768386","0.9737875","0.9740087","0.9561698","0.9458962","0.9428312","0.9395823","0.9367459","0.9090630","0.9086531","0.9091866","0.9121854","0.8903802","0.8934394","0.8804295","0.8815174","0.8615289","0.8435089","0.8416329","0.8475670","0.8360151","0.8170972","0.8227604","0.9157589","0.8985477","0.8851218","0.8836417","0.8883289","0.8723921","0.8753640","0.8760988","0.8767906","0.7783502","0.7399224","0.7382176","0.7042170","0.7780098","0.7925968","0.7939950","0.8008534","0.8122910","0.8124750","0.8108077","0.7774108","0.8249829"]]},"evals":["attrs.interactionModel"],"jsHooks":[]}</script>
</div>
<div id="rviews-2" class="section level2">
<h2>RViews</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Let&#39;s graph the sector/index rolling correlation using our old friend dygraphs. </span>
<span class="co"># I&#39;ll add an event for the financial crisis and shade the recession of 2007-2009 with </span>
<span class="co"># an unimposing pink hue.</span>

<span class="kw">dygraph</span>(IT_SPY_correlation$<span class="st">&#39;Sector/SPY Correlation&#39;</span>, <span class="dt">main =</span> <span class="st">&quot;Correlation between SP500 and Tech ETF&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">dyAxis</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Correlation&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">dyRangeSelector</span>(<span class="dt">height =</span> <span class="dv">20</span>) %&gt;%
<span class="st">    </span><span class="co"># Add shading for the recessionary period</span>
<span class="st">    </span><span class="kw">dyShading</span>(<span class="dt">from =</span> <span class="st">&quot;2007-12-01&quot;</span>, <span class="dt">to =</span> <span class="st">&quot;2009-06-01&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;#FFE6E6&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="co"># Add an event for the financial crisis. </span>
<span class="st">    </span><span class="kw">dyEvent</span>(<span class="dt">x =</span> <span class="st">&quot;2008-09-15&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Fin Crisis&quot;</span>, <span class="dt">labelLoc =</span> <span class="st">&quot;top&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
</div>
</div>
<div id="section-3" class="section level1">
<h1></h1>
<!---------------------------------------------------------->
</div>
<div id="final-thoughts" class="section level1">
<h1>Final Thoughts</h1>
<p>And that’s it! Hopefully you have seen that <code>tidyquant</code> is a great way to streamline and even scale your workflow better than most of the options out there. And we have only scratched the surface of what it can do!</p>
<p>You can check out the stable release of <code>tidyquant</code> from <a href="https://cran.r-project.org/web/packages/tidyquant/index.html">CRAN</a>, and the development release from <a href="https://github.com/mdancho84/tidyquant">Github</a>. Stay tuned for more to come!</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
